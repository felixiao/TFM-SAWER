-----------------------------------ARGUMENTS------------------------------------
model_name                               peter
dataset                                  amazon-toys
fold                                     0
cuda                                     True
test                                     False
no_generate                              False
seed                                     1111
no_train                                 False
log_file                                 ./Log/SEQ-FMLP_PETER.log
------------------------------------CONFIGS-------------------------------------
emsize                                   512
nhead                                    2
nhid                                     2048
nlayers                                  2
dropout                                  0.2
lr                                       1.0
pre_train                                False
optimizer                                SGD
scheduler                                steplr
warmup_epoch                             2
clip_norm                                1.0
epochs                                   100
batch_size                               128
load_direct                              True
continue_train                           False
log_interval                             4
vocab_size                               20000
text_len                                 15
endure_times                             5
rating_reg                               0.1
context_reg                              1.0
text_reg                                 1.0
item_reg                                 0.1
hist_len                                 0
user_len                                 1
item_len                                 1
use_feature                              True
seq_mode                                 0
peter_mask                               True
seq_prediction                           True
context_prediction                       True
rating_prediction                        True
nextitem_prediction                      False
-----------------------------------ARGUMENTS------------------------------------
[2023-01-15 10:10:47]: [GPU 0] World_Size(Num GPUs): 4
[2023-01-15 10:10:47]: [GPU 0] Loading data Fold ./Data/Amazon/ToysAndGames/0
[2023-01-15 10:10:47]: [GPU 0] Init Start
[2023-01-15 10:10:47]: [GPU 0] Init End
[2023-01-15 10:10:47]: [GPU 0] Load Start
[2023-01-15 10:10:48]: [GPU 0] train len:210871
[2023-01-15 10:10:48]: [GPU 0] Load End
[2023-01-15 10:10:49]: [GPU 0] text_reg:1.0, context_reg:1.0, rating_reg:0.1, item_reg:0.1
[2023-01-15 10:10:49]: [GPU 0] Device cuda
[2023-01-15 10:10:49]: [GPU 0] Loading data helper
[2023-01-15 10:10:49]: [GPU 0] Use Feature: True | src_len: 3
[2023-01-15 10:10:49]: [GPU 0] Building model PETER on device cuda
[2023-01-15 10:10:51]: [GPU 0] Save Mask to ./SEQUER/results/MASK_PETER+_PMask.png
[2023-01-15 10:10:53]: [GPU 0] Epoch 0 Start
[2023-01-15 10:11:11]: [GPU 0] context ppl 828.9263 | text ppl 161.4677 | rating loss 0.8216 | valid loss 990.4761 on validation
[2023-01-15 10:11:12]: [GPU 0] Epoch 0 | LR 1.0 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-01-15 10:11:12]: [GPU 0] Epoch 0 End | Time Used: 18.51

[2023-01-15 10:11:12]: [GPU 0] Epoch 1 Start
[2023-01-15 10:11:29]: [GPU 0] context ppl 616.4233 | text ppl 96.4276 | rating loss 0.8176 | valid loss 712.9326 on validation
[2023-01-15 10:11:30]: [GPU 0] Epoch 1 | LR 1.0 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-01-15 10:11:30]: [GPU 0] Epoch 1 End | Time Used: 17.81

[2023-01-15 10:11:30]: [GPU 0] Epoch 2 Start
[2023-01-15 10:11:47]: [GPU 0] context ppl 561.5092 | text ppl 70.4804 | rating loss 1.0466 | valid loss 632.0943 on validation
[2023-01-15 10:11:48]: [GPU 0] Epoch 2 | LR 1.0 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-01-15 10:11:48]: [GPU 0] Epoch 2 End | Time Used: 18.13

[2023-01-15 10:11:48]: [GPU 0] Epoch 3 Start
[2023-01-15 10:12:05]: [GPU 0] context ppl 583.8791 | text ppl 62.3747 | rating loss 0.9811 | valid loss 646.3519 on validation
[2023-01-15 10:12:05]: [GPU 0] Endured 1 / 5 time(s) | Learning rate set to 0.25000000
[2023-01-15 10:12:05]: [GPU 0] Epoch 3 End | Time Used: 17.49

[2023-01-15 10:12:05]: [GPU 0] Epoch 4 Start
[2023-01-15 10:12:23]: [GPU 0] context ppl 534.7441 | text ppl 55.6006 | rating loss 0.7966 | valid loss 590.4243 on validation
[2023-01-15 10:12:23]: [GPU 0] Epoch 4 | LR 0.25 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-01-15 10:12:23]: [GPU 0] Epoch 4 End | Time Used: 17.86

[2023-01-15 10:12:23]: [GPU 0] Epoch 5 Start
[2023-01-15 10:12:40]: [GPU 0] context ppl 530.7813 | text ppl 53.9299 | rating loss 0.7909 | valid loss 584.7903 on validation
[2023-01-15 10:12:41]: [GPU 0] Epoch 5 | LR 0.25 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-01-15 10:12:41]: [GPU 0] Epoch 5 End | Time Used: 17.76

[2023-01-15 10:12:41]: [GPU 0] Epoch 6 Start
[2023-01-15 10:12:58]: [GPU 0] context ppl 522.7804 | text ppl 52.4301 | rating loss 0.7849 | valid loss 575.2890 on validation
[2023-01-15 10:12:59]: [GPU 0] Epoch 6 | LR 0.25 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-01-15 10:12:59]: [GPU 0] Epoch 6 End | Time Used: 17.79

[2023-01-15 10:12:59]: [GPU 0] Epoch 7 Start
[2023-01-15 10:13:16]: [GPU 0] context ppl 520.4691 | text ppl 51.3609 | rating loss 0.7773 | valid loss 571.9077 on validation
[2023-01-15 10:13:16]: [GPU 0] Epoch 7 | LR 0.25 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-01-15 10:13:16]: [GPU 0] Epoch 7 End | Time Used: 17.71

[2023-01-15 10:13:16]: [GPU 0] Epoch 8 Start
[2023-01-15 10:13:34]: [GPU 0] context ppl 516.1887 | text ppl 50.2108 | rating loss 0.7714 | valid loss 566.4767 on validation
[2023-01-15 10:13:35]: [GPU 0] Epoch 8 | LR 0.25 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-01-15 10:13:35]: [GPU 0] Epoch 8 End | Time Used: 18.20

[2023-01-15 10:13:35]: [GPU 0] Epoch 9 Start
[2023-01-15 10:13:52]: [GPU 0] context ppl 512.1540 | text ppl 49.3582 | rating loss 0.7659 | valid loss 561.5888 on validation
[2023-01-15 10:13:52]: [GPU 0] Epoch 9 | LR 0.25 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-01-15 10:13:52]: [GPU 0] Epoch 9 End | Time Used: 17.68

[2023-01-15 10:13:52]: [GPU 0] Epoch 10 Start
[2023-01-15 10:14:10]: [GPU 0] context ppl 507.6582 | text ppl 48.1927 | rating loss 0.7645 | valid loss 555.9274 on validation
[2023-01-15 10:14:10]: [GPU 0] Epoch 10 | LR 0.25 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-01-15 10:14:10]: [GPU 0] Epoch 10 End | Time Used: 17.72

[2023-01-15 10:14:10]: [GPU 0] Epoch 11 Start
[2023-01-15 10:14:27]: [GPU 0] context ppl 505.5586 | text ppl 47.5819 | rating loss 0.7547 | valid loss 553.2160 on validation
[2023-01-15 10:14:28]: [GPU 0] Epoch 11 | LR 0.25 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-01-15 10:14:28]: [GPU 0] Epoch 11 End | Time Used: 17.57

[2023-01-15 10:14:28]: [GPU 0] Epoch 12 Start
[2023-01-15 10:14:45]: [GPU 0] context ppl 505.4911 | text ppl 46.8084 | rating loss 0.7532 | valid loss 552.3748 on validation
[2023-01-15 10:14:45]: [GPU 0] Epoch 12 | LR 0.25 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-01-15 10:14:45]: [GPU 0] Epoch 12 End | Time Used: 17.57

[2023-01-15 10:14:45]: [GPU 0] Epoch 13 Start
[2023-01-15 10:15:02]: [GPU 0] context ppl 499.9827 | text ppl 46.1891 | rating loss 0.7459 | valid loss 546.2464 on validation
[2023-01-15 10:15:03]: [GPU 0] Epoch 13 | LR 0.25 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-01-15 10:15:03]: [GPU 0] Epoch 13 End | Time Used: 17.57

[2023-01-15 10:15:03]: [GPU 0] Epoch 14 Start
[2023-01-15 10:15:20]: [GPU 0] context ppl 500.2028 | text ppl 45.7541 | rating loss 0.7429 | valid loss 546.0312 on validation
[2023-01-15 10:15:21]: [GPU 0] Epoch 14 | LR 0.25 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-01-15 10:15:21]: [GPU 0] Epoch 14 End | Time Used: 17.96

[2023-01-15 10:15:21]: [GPU 0] Epoch 15 Start
[2023-01-15 10:15:38]: [GPU 0] context ppl 495.6675 | text ppl 44.9095 | rating loss 0.7403 | valid loss 540.6510 on validation
[2023-01-15 10:15:38]: [GPU 0] Epoch 15 | LR 0.25 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-01-15 10:15:38]: [GPU 0] Epoch 15 End | Time Used: 17.57

[2023-01-15 10:15:38]: [GPU 0] Epoch 16 Start
[2023-01-15 10:15:55]: [GPU 0] context ppl 496.1957 | text ppl 44.7962 | rating loss 0.7349 | valid loss 541.0654 on validation
[2023-01-15 10:15:55]: [GPU 0] Endured 2 / 5 time(s) | Learning rate set to 0.06250000
[2023-01-15 10:15:55]: [GPU 0] Epoch 16 End | Time Used: 17.15

[2023-01-15 10:15:55]: [GPU 0] Epoch 17 Start
[2023-01-15 10:16:13]: [GPU 0] context ppl 495.4344 | text ppl 44.3688 | rating loss 0.7340 | valid loss 539.8765 on validation
[2023-01-15 10:16:13]: [GPU 0] Epoch 17 | LR 0.0625 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-01-15 10:16:13]: [GPU 0] Epoch 17 End | Time Used: 17.65

[2023-01-15 10:16:13]: [GPU 0] Epoch 18 Start
[2023-01-15 10:16:30]: [GPU 0] context ppl 494.9951 | text ppl 44.1358 | rating loss 0.7333 | valid loss 539.2043 on validation
[2023-01-15 10:16:31]: [GPU 0] Epoch 18 | LR 0.0625 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-01-15 10:16:31]: [GPU 0] Epoch 18 End | Time Used: 17.82

[2023-01-15 10:16:31]: [GPU 0] Epoch 19 Start
[2023-01-15 10:16:48]: [GPU 0] context ppl 494.9264 | text ppl 43.9936 | rating loss 0.7335 | valid loss 538.9934 on validation
[2023-01-15 10:16:49]: [GPU 0] Epoch 19 | LR 0.0625 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-01-15 10:16:49]: [GPU 0] Epoch 19 End | Time Used: 17.89

[2023-01-15 10:16:49]: [GPU 0] Epoch 20 Start
[2023-01-15 10:17:06]: [GPU 0] context ppl 494.9744 | text ppl 43.8876 | rating loss 0.7326 | valid loss 538.9352 on validation
[2023-01-15 10:17:07]: [GPU 0] Epoch 20 | LR 0.0625 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-01-15 10:17:07]: [GPU 0] Epoch 20 End | Time Used: 18.14

[2023-01-15 10:17:07]: [GPU 0] Epoch 21 Start
[2023-01-15 10:17:24]: [GPU 0] context ppl 495.1531 | text ppl 43.7789 | rating loss 0.7337 | valid loss 539.0053 on validation
[2023-01-15 10:17:24]: [GPU 0] Endured 3 / 5 time(s) | Learning rate set to 0.01562500
[2023-01-15 10:17:24]: [GPU 0] Epoch 21 End | Time Used: 17.39

[2023-01-15 10:17:24]: [GPU 0] Epoch 22 Start
[2023-01-15 10:17:42]: [GPU 0] context ppl 495.2055 | text ppl 43.7465 | rating loss 0.7333 | valid loss 539.0253 on validation
[2023-01-15 10:17:42]: [GPU 0] Endured 4 / 5 time(s) | Learning rate set to 0.00390625
[2023-01-15 10:17:42]: [GPU 0] Epoch 22 End | Time Used: 17.41

[2023-01-15 10:17:42]: [GPU 0] Epoch 23 Start
[2023-01-15 10:17:59]: [GPU 0] context ppl 494.9994 | text ppl 43.7314 | rating loss 0.7333 | valid loss 538.8041 on validation
[2023-01-15 10:18:00]: [GPU 0] Epoch 23 | LR 0.00390625 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-01-15 10:18:00]: [GPU 0] Epoch 23 End | Time Used: 17.90

[2023-01-15 10:18:00]: [GPU 0] Epoch 24 Start
[2023-01-15 10:18:17]: [GPU 0] context ppl 494.9872 | text ppl 43.7269 | rating loss 0.7333 | valid loss 538.7874 on validation
[2023-01-15 10:18:18]: [GPU 0] Epoch 24 | LR 0.00390625 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-01-15 10:18:18]: [GPU 0] Epoch 24 End | Time Used: 17.87

[2023-01-15 10:18:18]: [GPU 0] Epoch 25 Start
-----------------------------------ARGUMENTS------------------------------------
model_name                               peter
dataset                                  amazon-toys
fold                                     0
cuda                                     True
test                                     False
no_generate                              False
seed                                     1111
no_train                                 False
log_file                                 ./Log/SEQ-FMLP_PETER.log
------------------------------------CONFIGS-------------------------------------
emsize                                   512
nhead                                    2
nhid                                     2048
nlayers                                  2
dropout                                  0.2
lr                                       1.0
pre_train                                False
optimizer                                SGD
scheduler                                steplr
warmup_epoch                             2
clip_norm                                1.0
epochs                                   100
batch_size                               128
load_direct                              True
continue_train                           False
log_interval                             4
vocab_size                               20000
text_len                                 15
endure_times                             5
rating_reg                               0.1
context_reg                              1.0
text_reg                                 1.0
item_reg                                 0.1
hist_len                                 0
user_len                                 1
item_len                                 1
use_feature                              True
seq_mode                                 0
peter_mask                               True
seq_prediction                           True
context_prediction                       True
rating_prediction                        True
nextitem_prediction                      False
-----------------------------------ARGUMENTS------------------------------------
[2023-01-15 10:48:28]: [GPU 0] World_Size(Num GPUs): 4
