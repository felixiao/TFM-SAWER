-----------------------------------ARGUMENTS------------------------------------
model_name                               fmlpeter
dataset                                  amazon-movies
fold                                     0
cuda                                     True
test                                     False
no_generate                              False
seed                                     1111
no_train                                 False
log_file                                 ./Log/SEQ-FMLP_PETER.log
------------------------------------CONFIGS-------------------------------------
emsize                                   512
nhead                                    2
nhid                                     2048
nlayers                                  2
dropout                                  0.2
lr                                       0.001
optimizer                                AdamW
clip_norm                                0
epochs                                   50
batch_size                               128
continue_train                           False
log_interval                             4
vocab_size                               20000
text_len                                 15
endure_times                             5
rating_reg                               0.1
context_reg                              1.0
text_reg                                 1.0
item_reg                                 0.1
hist_len                                 20
user_len                                 0
item_len                                 1
use_feature                              True
seq_mode                                 2
peter_mask                               True
seq_prediction                           True
context_prediction                       True
rating_prediction                        True
nextitem_prediction                      False
-----------------------------------ARGUMENTS------------------------------------
[2023-01-09 14:27:43]: World_Size(Num GPUs): 4
[2023-01-09 14:27:47]: Init Start
[2023-01-09 14:27:47]: Init End
[2023-01-09 14:27:47]: Load Start
[2023-01-09 14:27:50]: train len:359303
[2023-01-09 14:27:51]: Load End
[2023-01-09 14:27:55]: [GPU 0] Device cuda
[2023-01-09 14:27:55]: [GPU 0] Loading data helper
[2023-01-09 14:27:55]: [GPU 0] Use Feature: True | src_len: 22
[2023-01-09 14:27:55]: [GPU 0] Building model FMLPETER on device cuda
[2023-01-09 14:27:57]: [GPU 0] LOAD FLMP MODEL FMLPRec-Movie_and_TV_index-Jan-04-2023_04-12-03_max20item.pt
[2023-01-09 14:28:01]: Save Mask to ./SEQUER/results/MASK-FMLP-PETER.png
[2023-01-09 14:28:01]: [GPU 0] Epoch 0
[2023-01-09 14:27:47]: Init Start
[2023-01-09 14:27:47]: Init End
[2023-01-09 14:27:47]: Load Start
[2023-01-09 14:27:49]: train len:359303
[2023-01-09 14:27:50]: Load End
[2023-01-09 14:28:01]: Save Mask to ./SEQUER/results/MASK-FMLP-PETER.png
[2023-01-09 14:27:47]: Init Start
[2023-01-09 14:27:47]: Init End
[2023-01-09 14:27:47]: Load Start
[2023-01-09 14:27:49]: train len:359303
[2023-01-09 14:27:50]: Load End
[2023-01-09 14:28:01]: Save Mask to ./SEQUER/results/MASK-FMLP-PETER.png
[2023-01-09 14:27:47]: Init Start
[2023-01-09 14:27:47]: Init End
[2023-01-09 14:27:47]: Load Start
[2023-01-09 14:27:49]: train len:359303
[2023-01-09 14:27:50]: Load End
[2023-01-09 14:28:01]: Save Mask to ./SEQUER/results/MASK-FMLP-PETER.png
[2023-01-09 14:29:06]: [GPU 0] context ppl 617.9164 | text ppl 296.9028 | rating loss 1.4374 | valid loss 7.1308 on validation
[2023-01-09 14:29:07]: [GPU 0] Epoch 0 | Training snapshot saved at ./SEQUER/checkpoints/fmlpeter_amazon-movies_0.pt
[2023-01-09 14:29:07]: [GPU 0] Epoch 0 Time Used: 65.76
[2023-01-09 14:29:07]: [GPU 0] Epoch 1
[2023-01-09 14:30:13]: [GPU 0] context ppl 581.5151 | text ppl 97.6568 | rating loss 1.4360 | valid loss 6.0175 on validation
[2023-01-09 14:30:13]: [GPU 0] Epoch 1 | Training snapshot saved at ./SEQUER/checkpoints/fmlpeter_amazon-movies_0.pt
[2023-01-09 14:30:13]: [GPU 0] Epoch 1 Time Used: 66.78
[2023-01-09 14:30:13]: [GPU 0] Epoch 2
[2023-01-09 14:31:19]: [GPU 0] context ppl 557.7430 | text ppl 70.3582 | rating loss 1.4484 | valid loss 5.7020 on validation
[2023-01-09 14:31:19]: [GPU 0] Epoch 2 | Training snapshot saved at ./SEQUER/checkpoints/fmlpeter_amazon-movies_0.pt
[2023-01-09 14:31:19]: [GPU 0] Epoch 2 Time Used: 66.13
[2023-01-09 14:31:19]: [GPU 0] Epoch 3
[2023-01-09 14:32:25]: [GPU 0] context ppl 542.7511 | text ppl 60.5887 | rating loss 1.4776 | valid loss 5.5817 on validation
[2023-01-09 14:32:25]: [GPU 0] Epoch 3 | Training snapshot saved at ./SEQUER/checkpoints/fmlpeter_amazon-movies_0.pt
[2023-01-09 14:32:25]: [GPU 0] Epoch 3 Time Used: 65.99
[2023-01-09 14:32:25]: [GPU 0] Epoch 4
[2023-01-09 14:33:31]: [GPU 0] context ppl 531.9572 | text ppl 55.2085 | rating loss 1.4491 | valid loss 5.4602 on validation
[2023-01-09 14:33:32]: [GPU 0] Epoch 4 | Training snapshot saved at ./SEQUER/checkpoints/fmlpeter_amazon-movies_0.pt
[2023-01-09 14:33:32]: [GPU 0] Epoch 4 Time Used: 66.15
[2023-01-09 14:33:32]: [GPU 0] Epoch 5
[2023-01-09 14:34:37]: [GPU 0] context ppl 524.0305 | text ppl 53.2131 | rating loss 1.4409 | valid loss 5.4152 on validation
[2023-01-09 14:34:37]: [GPU 0] Epoch 5 | Training snapshot saved at ./SEQUER/checkpoints/fmlpeter_amazon-movies_0.pt
[2023-01-09 14:34:37]: [GPU 0] Epoch 5 Time Used: 65.78
[2023-01-09 14:34:37]: [GPU 0] Epoch 6
[2023-01-09 14:35:43]: [GPU 0] context ppl 519.6759 | text ppl 52.4370 | rating loss 1.4369 | valid loss 5.3965 on validation
[2023-01-09 14:35:43]: [GPU 0] Epoch 6 | Training snapshot saved at ./SEQUER/checkpoints/fmlpeter_amazon-movies_0.pt
[2023-01-09 14:35:43]: [GPU 0] Epoch 6 Time Used: 65.80
[2023-01-09 14:35:43]: [GPU 0] Epoch 7
[2023-01-09 14:36:49]: [GPU 0] context ppl 513.9338 | text ppl 52.2251 | rating loss 1.4370 | valid loss 5.3925 on validation
[2023-01-09 14:36:49]: [GPU 0] Epoch 7 | Training snapshot saved at ./SEQUER/checkpoints/fmlpeter_amazon-movies_0.pt
[2023-01-09 14:36:49]: [GPU 0] Epoch 7 Time Used: 66.22
[2023-01-09 14:36:49]: [GPU 0] Epoch 8
[2023-01-09 14:37:55]: [GPU 0] context ppl 510.7346 | text ppl 52.1322 | rating loss 1.4434 | valid loss 5.3972 on validation
[2023-01-09 14:37:55]: [GPU 0] Endured 1 / 5 time(s) | Learning rate set to 0.00099331
[2023-01-09 14:37:55]: [GPU 0] Epoch 8 Time Used: 65.56
[2023-01-09 14:37:55]: [GPU 0] Epoch 9
[2023-01-09 14:39:00]: [GPU 0] context ppl 509.5731 | text ppl 52.3794 | rating loss 1.4346 | valid loss 5.3931 on validation
[2023-01-09 14:39:00]: [GPU 0] Endured 2 / 5 time(s) | Learning rate set to 0.00099038
[2023-01-09 14:39:00]: [GPU 0] Epoch 9 Time Used: 65.36
[2023-01-09 14:39:00]: [GPU 0] Epoch 10
[2023-01-09 14:40:07]: [GPU 0] context ppl 509.8962 | text ppl 52.9290 | rating loss 1.4346 | valid loss 5.4035 on validation
[2023-01-09 14:40:07]: [GPU 0] Endured 3 / 5 time(s) | Learning rate set to 0.00098692
[2023-01-09 14:40:07]: [GPU 0] Epoch 10 Time Used: 66.46
[2023-01-09 14:40:07]: [GPU 0] Epoch 11
[2023-01-09 14:41:12]: [GPU 0] context ppl 507.8661 | text ppl 53.6581 | rating loss 1.4400 | valid loss 5.4227 on validation
[2023-01-09 14:41:12]: [GPU 0] Endured 4 / 5 time(s) | Learning rate set to 0.00098295
[2023-01-09 14:41:12]: [GPU 0] Epoch 11 Time Used: 65.71
[2023-01-09 14:41:12]: [GPU 0] Epoch 12
[2023-01-09 14:42:18]: [GPU 0] context ppl 508.4998 | text ppl 53.7599 | rating loss 1.4365 | valid loss 5.4210 on validation
[2023-01-09 14:42:18]: [GPU 0] Endured 5 / 5 time(s)| Cannot endure it anymore | Exiting from early stop
