-----------------------------------ARGUMENTS------------------------------------
model_name                               peter
dataset                                  amazon-toys
fold                                     0
cuda                                     True
test                                     False
no_generate                              False
seed                                     1111
no_train                                 False
log_file                                 ./Log/SEQ-FMLP_PETER.log
------------------------------------CONFIGS-------------------------------------
emsize                                   512
nhead                                    2
nhid                                     2048
nlayers                                  2
dropout                                  0.2
lr                                       1.0
pre_train                                False
optimizer                                SGD
scheduler                                steplr
warmup_epoch                             2
clip_norm                                1.0
epochs                                   100
batch_size                               128
load_direct                              False
continue_train                           False
log_interval                             4
vocab_size                               20000
text_len                                 15
endure_times                             5
rating_reg                               0.1
context_reg                              1.0
text_reg                                 1.0
item_reg                                 0.1
hist_len                                 0
user_len                                 1
item_len                                 1
use_feature                              True
seq_mode                                 0
peter_mask                               True
seq_prediction                           True
context_prediction                       True
rating_prediction                        True
nextitem_prediction                      False
-----------------------------------ARGUMENTS------------------------------------
[2023-02-13 09:29:09 GPU 0]: World_Size(Num GPUs): 1
[2023-02-13 09:29:09 GPU 0]: Loading data Fold ./Data/Amazon/ToysAndGames/0
[2023-02-13 09:29:10 GPU 0]: reviews <built-in method index of list object at 0x7f82af568400>
[2023-02-13 09:29:17 GPU 0]: user dict count:19412
item dict count:11928
word dict count:405986
max rating:5.0
min rating:1.0
[2023-02-13 09:29:27 GPU 0]: text_reg:1.0, context_reg:1.0, rating_reg:0.1, item_reg:0.1
[2023-02-13 09:29:27 GPU 0]: Device cuda
[2023-02-13 09:29:27 GPU 0]: Loading data helper
[2023-02-13 09:29:27 GPU 0]: Use Feature: True | src_len: 3
[2023-02-13 09:29:27 GPU 0]: Building model PETER on device cuda
[2023-02-13 09:29:28 GPU 0]: Save Mask to ./SEQUER/results/MASK_PETER+_PMask.png
[2023-02-13 09:29:32 GPU 0]: Epoch 0 Start
[2023-02-13 09:29:55 GPU 0]: context ppl 677.3314 | text ppl 84.9929 | rating loss 1.0669 | seq loss 0.0000 | valid loss 762.4310 on validation
[2023-02-13 09:29:56 GPU 0]: Epoch 0 | LR 1.0 | Num History 1 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-02-13 09:29:56 GPU 0]: Epoch 0 End | Time Used: 24.16

[2023-02-13 09:29:56 GPU 0]: Epoch 1 Start
[2023-02-13 09:30:20 GPU 0]: context ppl 646.3834 | text ppl 62.4503 | rating loss 0.9788 | seq loss 0.0000 | valid loss 708.9316 on validation
[2023-02-13 09:30:21 GPU 0]: Epoch 1 | LR 1.0 | Num History 2 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-02-13 09:30:21 GPU 0]: Epoch 1 End | Time Used: 24.73

[2023-02-13 09:30:21 GPU 0]: Epoch 2 Start
[2023-02-13 09:30:44 GPU 0]: context ppl 600.8951 | text ppl 53.0087 | rating loss 0.9697 | seq loss 0.0000 | valid loss 654.0008 on validation
[2023-02-13 09:30:45 GPU 0]: Epoch 2 | LR 1.0 | Num History 3 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-02-13 09:30:45 GPU 0]: Epoch 2 End | Time Used: 24.22

[2023-02-13 09:30:45 GPU 0]: Epoch 3 Start
[2023-02-13 09:31:09 GPU 0]: context ppl 582.8155 | text ppl 49.8171 | rating loss 0.9608 | seq loss 0.0000 | valid loss 632.7287 on validation
[2023-02-13 09:31:10 GPU 0]: Epoch 3 | LR 1.0 | Num History 4 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-02-13 09:31:10 GPU 0]: Epoch 3 End | Time Used: 24.70

[2023-02-13 09:31:10 GPU 0]: Epoch 4 Start
[2023-02-13 09:31:34 GPU 0]: context ppl 562.9406 | text ppl 45.2779 | rating loss 0.9844 | seq loss 0.0000 | valid loss 608.3170 on validation
[2023-02-13 09:31:34 GPU 0]: Epoch 4 | LR 1.0 | Num History 5 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-02-13 09:31:34 GPU 0]: Epoch 4 End | Time Used: 24.74

[2023-02-13 09:31:34 GPU 0]: Epoch 5 Start
[2023-02-13 09:31:58 GPU 0]: context ppl 538.9174 | text ppl 42.6205 | rating loss 0.9087 | seq loss 0.0000 | valid loss 581.6288 on validation
[2023-02-13 09:31:59 GPU 0]: Epoch 5 | LR 1.0 | Num History 6 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-02-13 09:31:59 GPU 0]: Epoch 5 End | Time Used: 24.28

[2023-02-13 09:31:59 GPU 0]: Epoch 6 Start
[2023-02-13 09:32:23 GPU 0]: context ppl 522.6399 | text ppl 41.3246 | rating loss 0.9135 | seq loss 0.0000 | valid loss 564.0559 on validation
[2023-02-13 09:32:23 GPU 0]: Epoch 6 | LR 1.0 | Num History 7 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-02-13 09:32:23 GPU 0]: Epoch 6 End | Time Used: 24.75

[2023-02-13 09:32:23 GPU 0]: Epoch 7 Start
[2023-02-13 09:32:47 GPU 0]: context ppl 511.9651 | text ppl 40.0045 | rating loss 0.8576 | seq loss 0.0000 | valid loss 552.0554 on validation
[2023-02-13 09:32:48 GPU 0]: Epoch 7 | LR 1.0 | Num History 8 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-02-13 09:32:48 GPU 0]: Epoch 7 End | Time Used: 24.29

[2023-02-13 09:32:48 GPU 0]: Epoch 8 Start
[2023-02-13 09:33:12 GPU 0]: context ppl 500.5114 | text ppl 38.0473 | rating loss 0.8902 | seq loss 0.0000 | valid loss 538.6478 on validation
[2023-02-13 09:33:12 GPU 0]: Epoch 8 | LR 1.0 | Num History 9 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-02-13 09:33:12 GPU 0]: Epoch 8 End | Time Used: 24.72

[2023-02-13 09:33:12 GPU 0]: Epoch 9 Start
[2023-02-13 09:33:37 GPU 0]: context ppl 488.9202 | text ppl 36.6544 | rating loss 0.8296 | seq loss 0.0000 | valid loss 525.6575 on validation
[2023-02-13 09:33:37 GPU 0]: Epoch 9 | LR 1.0 | Num History 10 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-02-13 09:33:37 GPU 0]: Epoch 9 End | Time Used: 24.64

[2023-02-13 09:33:37 GPU 0]: Epoch 10 Start
[2023-02-13 09:34:01 GPU 0]: context ppl 481.2123 | text ppl 36.1952 | rating loss 0.8254 | seq loss 0.0000 | valid loss 517.4900 on validation
[2023-02-13 09:34:01 GPU 0]: Epoch 10 | LR 1.0 | Num History 11 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-02-13 09:34:01 GPU 0]: Epoch 10 End | Time Used: 24.30

[2023-02-13 09:34:01 GPU 0]: Epoch 11 Start
[2023-02-13 09:34:26 GPU 0]: context ppl 476.6931 | text ppl 36.0292 | rating loss 0.8256 | seq loss 0.0000 | valid loss 512.8049 on validation
[2023-02-13 09:34:26 GPU 0]: Epoch 11 | LR 1.0 | Num History 12 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-02-13 09:34:26 GPU 0]: Epoch 11 End | Time Used: 24.77

[2023-02-13 09:34:26 GPU 0]: Epoch 12 Start
[2023-02-13 09:34:50 GPU 0]: context ppl 476.9308 | text ppl 35.2291 | rating loss 0.8255 | seq loss 0.0000 | valid loss 512.2425 on validation
[2023-02-13 09:34:51 GPU 0]: Epoch 12 | LR 1.0 | Num History 13 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-02-13 09:34:51 GPU 0]: Epoch 12 End | Time Used: 24.61

[2023-02-13 09:34:51 GPU 0]: Epoch 13 Start
[2023-02-13 09:35:15 GPU 0]: context ppl 470.3668 | text ppl 35.2280 | rating loss 0.8456 | seq loss 0.0000 | valid loss 505.6794 on validation
[2023-02-13 09:35:15 GPU 0]: Epoch 13 | LR 1.0 | Num History 14 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-toys_0.pt
[2023-02-13 09:35:15 GPU 0]: Epoch 13 End | Time Used: 24.32

[2023-02-13 09:35:15 GPU 0]: Epoch 14 Start
[2023-02-13 09:35:39 GPU 0]: context ppl 470.9788 | text ppl 34.8933 | rating loss 0.8210 | seq loss 0.0000 | valid loss 505.9542 on validation
[2023-02-13 09:35:39 GPU 0]: Endured 1 / 5 time(s) | Learning rate set to 0.25000000
[2023-02-13 09:35:39 GPU 0]: Epoch 14 End | Time Used: 24.25

[2023-02-13 09:35:39 GPU 0]: Epoch 15 Start
[2023-02-13 09:36:03 GPU 0]: context ppl 472.4891 | text ppl 33.6175 | rating loss 0.8354 | seq loss 0.0000 | valid loss 506.1901 on validation
[2023-02-13 09:36:03 GPU 0]: Endured 2 / 5 time(s) | Learning rate set to 0.06250000
[2023-02-13 09:36:03 GPU 0]: Epoch 15 End | Time Used: 23.75

[2023-02-13 09:36:03 GPU 0]: Epoch 16 Start
[2023-02-13 09:36:27 GPU 0]: context ppl 473.6392 | text ppl 33.3965 | rating loss 0.8543 | seq loss 0.0000 | valid loss 507.1211 on validation
[2023-02-13 09:36:27 GPU 0]: Endured 3 / 5 time(s) | Learning rate set to 0.01562500
[2023-02-13 09:36:27 GPU 0]: Epoch 16 End | Time Used: 24.18

[2023-02-13 09:36:27 GPU 0]: Epoch 17 Start
[2023-02-13 09:36:51 GPU 0]: context ppl 475.4594 | text ppl 33.4200 | rating loss 0.8476 | seq loss 0.0000 | valid loss 508.9642 on validation
[2023-02-13 09:36:51 GPU 0]: Endured 4 / 5 time(s) | Learning rate set to 0.00390625
[2023-02-13 09:36:51 GPU 0]: Epoch 17 End | Time Used: 24.22

[2023-02-13 09:36:51 GPU 0]: Epoch 18 Start
[2023-02-13 09:37:15 GPU 0]: context ppl 475.8004 | text ppl 33.4377 | rating loss 0.8474 | seq loss 0.0000 | valid loss 509.3228 on validation
[2023-02-13 09:37:15 GPU 0]: Endured 5 / 5 time(s)| Cannot endure it anymore | Exiting from early stop
[2023-02-13 09:37:15 GPU 0]: Epoch 18 End | Time Used: 23.82

[2023-02-13 09:37:15 GPU 0]: Training Finished | Time Used: 463.46
--------------------------------------------------------------------------------
[2023-02-13 09:37:15 GPU 0]: Building model PETER on device cuda
[2023-02-13 09:37:16 GPU 0]: Save Mask to ./SEQUER/results/MASK_PETER+_PMask.png
[2023-02-13 09:37:17 GPU 0]: Resuming training from snapshot at Epoch 13, Num History 14
=========================================================================================
[2023-02-13 09:37:17 GPU 0]: context ppl 469.4587 | text ppl 34.8601 | rating loss 0.8628 | seq loss 0.0000 | loss 504.4051 on test |End of training
[2023-02-13 09:37:17 GPU 0]: Generating text
[2023-02-13 09:37:19 GPU 0]: RMSE↓  0.9289
[2023-02-13 09:37:19 GPU 0]: MAE↓  0.6864
[2023-02-13 09:37:19 GPU 0]: idss_predict 6168, tokens_predict 6168
[2023-02-13 09:37:20 GPU 0]: BLEU_1↑ 17.8159
[2023-02-13 09:37:20 GPU 0]: BLEU_4↑  2.2515
[2023-02-13 09:37:26 GPU 0]: USR↑  0.7187 | USN↑    4433
[2023-02-13 09:37:29 GPU 0]: DIV↓  0.2575
[2023-02-13 09:37:29 GPU 0]: FCR↑  0.1963
[2023-02-13 09:37:29 GPU 0]: FMR↑  0.2693
[2023-02-13 09:37:30 GPU 0]: R1_F↑ 19.0834
[2023-02-13 09:37:30 GPU 0]: R1_R↑ 18.1408
[2023-02-13 09:37:30 GPU 0]: R1_P↑ 20.8358
[2023-02-13 09:37:30 GPU 0]: R2_F↑  3.7501
[2023-02-13 09:37:30 GPU 0]: R2_R↑  3.6183
[2023-02-13 09:37:30 GPU 0]: R2_P↑  4.0468
[2023-02-13 09:37:30 GPU 0]: RL_F↑ 15.2132
[2023-02-13 09:37:30 GPU 0]: RL_R↑ 15.2365
[2023-02-13 09:37:30 GPU 0]: RL_P↑ 15.2626
[2023-02-13 09:37:30 GPU 0]: Saved result to ./SEQUER/results/results.csv
[2023-02-13 09:37:30 GPU 0]: Generated text saved to ./SEQUER/checkpoints/generated_amazon-toys_0_peter.txt
