-----------------------------------ARGUMENTS------------------------------------
model_name                               peter
dataset                                  amazon-movies
fold                                     0
cuda                                     True
test                                     False
no_generate                              False
seed                                     1111
no_train                                 False
log_file                                 ./Log/SEQ-FMLP_PETER.log
------------------------------------CONFIGS-------------------------------------
emsize                                   512
nhead                                    2
nhid                                     2048
nlayers                                  2
dropout                                  0.2
lr                                       1.0
pre_train                                False
optimizer                                SGD
scheduler                                steplr
warmup_epoch                             2
clip_norm                                1.0
epochs                                   100
batch_size                               128
load_direct                              True
continue_train                           False
log_interval                             4
vocab_size                               20000
text_len                                 15
endure_times                             5
rating_reg                               0.1
context_reg                              1.0
text_reg                                 1.0
item_reg                                 0.1
hist_len                                 0
user_len                                 1
item_len                                 1
use_feature                              True
seq_mode                                 0
peter_mask                               True
seq_prediction                           True
context_prediction                       True
rating_prediction                        True
nextitem_prediction                      False
-----------------------------------ARGUMENTS------------------------------------
[2023-02-10 21:28:34 GPU 0]: World_Size(Num GPUs): 1
[2023-02-10 21:28:34 GPU 0]: Loading data Fold ./Data/Amazon/MoviesAndTV_New/0
[2023-02-10 21:28:34 GPU 0]: Init Start
[2023-02-10 21:28:34 GPU 0]: Init End
[2023-02-10 21:28:34 GPU 0]: Load Start
[2023-02-10 21:28:37 GPU 0]: train len:359303
[2023-02-10 21:28:37 GPU 0]: Load End
[2023-02-10 21:28:39 GPU 0]: text_reg:1.0, context_reg:1.0, rating_reg:0.1, item_reg:0.1
[2023-02-10 21:28:39 GPU 0]: Device cuda
[2023-02-10 21:28:39 GPU 0]: Loading data helper
[2023-02-10 21:28:39 GPU 0]: Use Feature: True | src_len: 3
[2023-02-10 21:28:39 GPU 0]: Building model PETER on device cuda
[2023-02-10 21:28:40 GPU 0]: Save Mask to ./SEQUER/results/MASK_PETER+_PMask.png
[2023-02-10 21:28:44 GPU 0]: Epoch 0 Start
[2023-02-10 21:29:35 GPU 0]: context ppl 615.2939 | text ppl 100.2433 | rating loss 1.5836 | seq loss 0.0000 | valid loss 715.6956 on validation
[2023-02-10 21:29:35 GPU 0]: peter: Ep 0 Len 1
[2023-02-10 21:29:35 GPU 0]: Epoch 0 | LR 1.0 | Num History 1 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-movies_0.pt
[2023-02-10 21:29:35 GPU 0]: Epoch 0 End | Time Used: 51.18

[2023-02-10 21:29:35 GPU 0]: Epoch 1 Start
[2023-02-10 21:30:27 GPU 0]: context ppl 591.3137 | text ppl 76.2185 | rating loss 1.2729 | seq loss 0.0000 | valid loss 667.6595 on validation
[2023-02-10 21:30:27 GPU 0]: peter: Ep 1 Len 2
[2023-02-10 21:30:27 GPU 0]: Epoch 1 | LR 1.0 | Num History 2 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-movies_0.pt
[2023-02-10 21:30:27 GPU 0]: Epoch 1 End | Time Used: 52.34

[2023-02-10 21:30:27 GPU 0]: Epoch 2 Start
[2023-02-10 21:31:19 GPU 0]: context ppl 584.4984 | text ppl 68.9315 | rating loss 1.0903 | seq loss 0.0000 | valid loss 653.5389 on validation
[2023-02-10 21:31:19 GPU 0]: peter: Ep 2 Len 3
[2023-02-10 21:31:19 GPU 0]: Epoch 2 | LR 1.0 | Num History 3 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-movies_0.pt
[2023-02-10 21:31:19 GPU 0]: Epoch 2 End | Time Used: 51.92

[2023-02-10 21:31:19 GPU 0]: Epoch 3 Start
[2023-02-10 21:32:12 GPU 0]: context ppl 551.8739 | text ppl 61.2526 | rating loss 1.0178 | seq loss 0.0000 | valid loss 613.2283 on validation
[2023-02-10 21:32:12 GPU 0]: peter: Ep 3 Len 4
[2023-02-10 21:32:12 GPU 0]: Epoch 3 | LR 1.0 | Num History 4 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-movies_0.pt
[2023-02-10 21:32:12 GPU 0]: Epoch 3 End | Time Used: 52.70

[2023-02-10 21:32:12 GPU 0]: Epoch 4 Start
[2023-02-10 21:33:04 GPU 0]: context ppl 541.1777 | text ppl 57.3904 | rating loss 1.0456 | seq loss 0.0000 | valid loss 598.6726 on validation
[2023-02-10 21:33:04 GPU 0]: peter: Ep 4 Len 5
[2023-02-10 21:33:04 GPU 0]: Epoch 4 | LR 1.0 | Num History 5 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-movies_0.pt
[2023-02-10 21:33:04 GPU 0]: Epoch 4 End | Time Used: 52.10

[2023-02-10 21:33:04 GPU 0]: Epoch 5 Start
[2023-02-10 21:33:56 GPU 0]: context ppl 534.2380 | text ppl 55.4613 | rating loss 1.0122 | seq loss 0.0000 | valid loss 589.8005 on validation
[2023-02-10 21:33:56 GPU 0]: peter: Ep 5 Len 6
[2023-02-10 21:33:57 GPU 0]: Epoch 5 | LR 1.0 | Num History 6 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-movies_0.pt
[2023-02-10 21:33:57 GPU 0]: Epoch 5 End | Time Used: 52.46

[2023-02-10 21:33:57 GPU 0]: Epoch 6 Start
[2023-02-10 21:34:50 GPU 0]: context ppl 526.1479 | text ppl 53.3248 | rating loss 1.0275 | seq loss 0.0000 | valid loss 579.5754 on validation
[2023-02-10 21:34:50 GPU 0]: peter: Ep 6 Len 7
[2023-02-10 21:34:50 GPU 0]: Epoch 6 | LR 1.0 | Num History 7 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-movies_0.pt
[2023-02-10 21:34:50 GPU 0]: Epoch 6 End | Time Used: 53.29

[2023-02-10 21:34:50 GPU 0]: Epoch 7 Start
[2023-02-10 21:35:42 GPU 0]: context ppl 521.0271 | text ppl 51.5479 | rating loss 1.0039 | seq loss 0.0000 | valid loss 572.6754 on validation
[2023-02-10 21:35:42 GPU 0]: peter: Ep 7 Len 8
[2023-02-10 21:35:42 GPU 0]: Epoch 7 | LR 1.0 | Num History 8 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-movies_0.pt
[2023-02-10 21:35:42 GPU 0]: Epoch 7 End | Time Used: 52.24

[2023-02-10 21:35:42 GPU 0]: Epoch 8 Start
[2023-02-10 21:36:34 GPU 0]: context ppl 520.0485 | text ppl 51.3310 | rating loss 0.9907 | seq loss 0.0000 | valid loss 571.4785 on validation
[2023-02-10 21:36:34 GPU 0]: peter: Ep 8 Len 9
[2023-02-10 21:36:35 GPU 0]: Epoch 8 | LR 1.0 | Num History 9 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-movies_0.pt
[2023-02-10 21:36:35 GPU 0]: Epoch 8 End | Time Used: 52.53

[2023-02-10 21:36:35 GPU 0]: Epoch 9 Start
[2023-02-10 21:37:26 GPU 0]: context ppl 506.6990 | text ppl 49.4565 | rating loss 1.0255 | seq loss 0.0000 | valid loss 556.2581 on validation
[2023-02-10 21:37:26 GPU 0]: peter: Ep 9 Len 10
[2023-02-10 21:37:26 GPU 0]: Epoch 9 | LR 1.0 | Num History 10 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-movies_0.pt
[2023-02-10 21:37:26 GPU 0]: Epoch 9 End | Time Used: 51.49

[2023-02-10 21:37:26 GPU 0]: Epoch 10 Start
[2023-02-10 21:38:18 GPU 0]: context ppl 509.9109 | text ppl 48.7437 | rating loss 1.0559 | seq loss 0.0000 | valid loss 558.7602 on validation
[2023-02-10 21:38:18 GPU 0]: peter: Ep 10 Len 11
[2023-02-10 21:38:18 GPU 0]: Endured 1 / 5 time(s) | Learning rate set to 0.25000000
[2023-02-10 21:38:18 GPU 0]: Epoch 10 End | Time Used: 51.84

[2023-02-10 21:38:18 GPU 0]: Epoch 11 Start
[2023-02-10 21:39:09 GPU 0]: context ppl 497.9392 | text ppl 45.6152 | rating loss 0.9677 | seq loss 0.0000 | valid loss 543.6511 on validation
[2023-02-10 21:39:09 GPU 0]: peter: Ep 11 Len 12
[2023-02-10 21:39:09 GPU 0]: Epoch 11 | LR 0.25 | Num History 12 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-movies_0.pt
[2023-02-10 21:39:09 GPU 0]: Epoch 11 End | Time Used: 51.25

[2023-02-10 21:39:09 GPU 0]: Epoch 12 Start
[2023-02-10 21:40:02 GPU 0]: context ppl 496.2243 | text ppl 45.0100 | rating loss 0.9715 | seq loss 0.0000 | valid loss 541.3315 on validation
[2023-02-10 21:40:02 GPU 0]: peter: Ep 12 Len 13
[2023-02-10 21:40:02 GPU 0]: Epoch 12 | LR 0.25 | Num History 13 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-movies_0.pt
[2023-02-10 21:40:02 GPU 0]: Epoch 12 End | Time Used: 52.55

[2023-02-10 21:40:02 GPU 0]: Epoch 13 Start
[2023-02-10 21:40:53 GPU 0]: context ppl 497.0348 | text ppl 44.9248 | rating loss 0.9752 | seq loss 0.0000 | valid loss 542.0572 on validation
[2023-02-10 21:40:53 GPU 0]: peter: Ep 13 Len 14
[2023-02-10 21:40:53 GPU 0]: Endured 2 / 5 time(s) | Learning rate set to 0.06250000
[2023-02-10 21:40:53 GPU 0]: Epoch 13 End | Time Used: 51.22

[2023-02-10 21:40:53 GPU 0]: Epoch 14 Start
[2023-02-10 21:41:45 GPU 0]: context ppl 495.6364 | text ppl 44.4807 | rating loss 0.9735 | seq loss 0.0000 | valid loss 540.2145 on validation
[2023-02-10 21:41:45 GPU 0]: peter: Ep 14 Len 15
[2023-02-10 21:41:45 GPU 0]: Epoch 14 | LR 0.0625 | Num History 15 | Training snapshot saved at ./SEQUER/checkpoints/peter_amazon-movies_0.pt
[2023-02-10 21:41:45 GPU 0]: Epoch 14 End | Time Used: 51.97

[2023-02-10 21:41:45 GPU 0]: Epoch 15 Start
[2023-02-10 21:42:36 GPU 0]: context ppl 496.0753 | text ppl 44.3913 | rating loss 0.9716 | seq loss 0.0000 | valid loss 540.5638 on validation
[2023-02-10 21:42:36 GPU 0]: peter: Ep 15 Len 16
[2023-02-10 21:42:36 GPU 0]: Endured 3 / 5 time(s) | Learning rate set to 0.01562500
[2023-02-10 21:42:36 GPU 0]: Epoch 15 End | Time Used: 51.12

[2023-02-10 21:42:36 GPU 0]: Epoch 16 Start
[2023-02-10 21:43:28 GPU 0]: context ppl 496.6353 | text ppl 44.3856 | rating loss 0.9739 | seq loss 0.0000 | valid loss 541.1183 on validation
[2023-02-10 21:43:28 GPU 0]: peter: Ep 16 Len 17
[2023-02-10 21:43:28 GPU 0]: Endured 4 / 5 time(s) | Learning rate set to 0.00390625
[2023-02-10 21:43:28 GPU 0]: Epoch 16 End | Time Used: 51.68

[2023-02-10 21:43:28 GPU 0]: Epoch 17 Start
[2023-02-10 21:44:20 GPU 0]: context ppl 496.2772 | text ppl 44.3884 | rating loss 0.9735 | seq loss 0.0000 | valid loss 540.7630 on validation
[2023-02-10 21:44:20 GPU 0]: peter: Ep 17 Len 18
[2023-02-10 21:44:20 GPU 0]: Endured 5 / 5 time(s)| Cannot endure it anymore | Exiting from early stop
[2023-02-10 21:44:20 GPU 0]: Epoch 17 End | Time Used: 51.94

[2023-02-10 21:44:20 GPU 0]: Training Finished | Time Used: 935.81
--------------------------------------------------------------------------------
[2023-02-10 21:44:20 GPU 0]: Building model PETER on device cuda
[2023-02-10 21:44:21 GPU 0]: Save Mask to ./SEQUER/results/MASK_PETER+_PMask.png
[2023-02-10 21:44:21 GPU 0]: Resuming training from snapshot at Epoch 14, Num History 15
=========================================================================================
[2023-02-10 21:44:23 GPU 0]: context ppl 492.6777 | text ppl 44.2860 | rating loss 0.9482 | seq loss 1.0000 | loss 537.1586 on test |End of training
[2023-02-10 21:44:23 GPU 0]: Generating text
[2023-02-10 21:44:33 GPU 0]: RMSE↓  0.9737
[2023-02-10 21:44:33 GPU 0]: MAE↓  0.7294
[2023-02-10 21:44:33 GPU 0]: idss_predict 41240, tokens_predict 41240
[2023-02-10 21:44:34 GPU 0]: BLEU_1↑ 19.4820
[2023-02-10 21:44:37 GPU 0]: BLEU_4↑  2.9124
[2023-02-10 21:45:25 GPU 0]: USR↑  0.4192 | USN↑   17288
[2023-02-10 21:49:41 GPU 0]: DIV↓  1.2196
[2023-02-10 21:49:42 GPU 0]: FCR↑  0.2803
[2023-02-10 21:49:42 GPU 0]: FMR↑  0.7789
[2023-02-10 21:49:45 GPU 0]: R1_F↑ 26.1109
[2023-02-10 21:49:45 GPU 0]: R1_R↑ 23.7275
[2023-02-10 21:49:45 GPU 0]: R1_P↑ 34.6365
[2023-02-10 21:49:45 GPU 0]: R2_F↑  6.5025
[2023-02-10 21:49:45 GPU 0]: R2_R↑  6.0179
[2023-02-10 21:49:45 GPU 0]: R2_P↑  8.7712
[2023-02-10 21:49:45 GPU 0]: RL_F↑ 19.6909
[2023-02-10 21:49:45 GPU 0]: RL_R↑ 21.0673
[2023-02-10 21:49:45 GPU 0]: RL_P↑ 28.0238
[2023-02-10 21:49:45 GPU 0]: Index(['Model', 'Dataset', 'Split_ID', 'TestTime', 'Seed', 'RMSE↓', 'MAE↓',
       'DIV↓', 'USR↑', 'USN↑', 'FCR↑', 'FMR↑', 'BLEU_1↑', 'BLEU_4↑', 'R1_F↑',
       'R1_P↑', 'R1_R↑', 'R2_F↑', 'R2_P↑', 'R2_R↑', 'RL_F↑', 'RL_P↑', 'RL_R↑',
       'HistLen', 'TextLen', 'Batch_size', 'Optimizer', 'LR', 'Total_Epoch',
       'Train_Time', 'Epoch_Time', 'Num_GPU', 'GPU_ID'],
      dtype='object')
[2023-02-10 21:49:45 GPU 0]: Model           object
Dataset         object
Split_ID         int64
TestTime        object
Seed             int64
RMSE↓          float64
MAE↓           float64
DIV↓           float64
USR↑           float64
USN↑             int64
FCR↑           float64
FMR↑           float64
BLEU_1↑        float64
BLEU_4↑        float64
R1_F↑          float64
R1_P↑          float64
R1_R↑          float64
R2_F↑          float64
R2_P↑          float64
R2_R↑          float64
RL_F↑          float64
RL_P↑          float64
RL_R↑          float64
HistLen          int64
TextLen          int64
Batch_size       int64
Optimizer       object
LR             float64
Total_Epoch      int64
Train_Time      object
Epoch_Time      object
Num_GPU          int64
GPU_ID           int64
dtype: object
[2023-02-10 21:49:45 GPU 0]: Saved result to ./SEQUER/results/results.csv
[2023-02-10 21:49:46 GPU 0]: Generated text saved to ./SEQUER/checkpoints/generated_amazon-movies_0_peter.txt
