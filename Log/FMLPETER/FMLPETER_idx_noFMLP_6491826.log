-------------------------PETER ARGUMENTS-------------------------
data_path            FMLPETER/data/Movie_and_TV_index.pickle
index_dir            FMLPETER/data/0
checkpoint           FMLPETER/output
outf                 generated_seed1234.txt
emsize               512
nhead                2
nhid                 2048
nlayers              2
dropout              0.2
lr                   0.9
clip                 1.0
epochs               200
batch_size           256
seed                 1234
cuda                 True
log_interval         324
max_hist_len         20
vocab_size           20000
endure_times         10
rating_reg           0.1
context_reg          1.0
text_reg             1.0
peter_mask           True
use_feature          True
words                15
mode                 Train+Test
model_path           FMLPETER/output/model_feat_2022-12-16 14:50:23.pt
prediction_path      FMLPETER/output/generated_seed1234.txt
-------------------------PETER ARGUMENTS-------------------------
[2022-12-16 14:50:23.66]: Loading data
Train Count: 359303
Valid Count: 41240
Test Count: 41240
Total Count: 441783
train idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
train: [{'user': 0, 'user_index': 0, 'item': 0, 'item_index': 3284, 'hist_index': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'rating': 5, 'text': [12, 8, 35, 379, 11, 4, 687, 6, 171, 93, 10, 25, 1523, 22, 182, 5, 462, 4628], 'feature': 11}, {'user': 0, 'user_index': 0, 'item': 1, 'item_index': 3123, 'hist_index': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3284], 'rating': 5, 'text': [12, 11, 19, 10, 26, 1523, 60, 13, 2265, 51, 19, 39, 5, 771, 2465, 10, 4, 406, 11, 13, 19, 1124, 66, 14, 19, 1086, 342, 13], 'feature': 11}, {'user': 0, 'user_index': 0, 'item': 2, 'item_index': 4530, 'hist_index': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3284, 3123], 'rating': 5, 'text': [12, 8, 5, 25, 186, 116, 4, 711, 205, 1042, 16213, 8, 27, 7, 4, 65, 47, 148, 12, 8, 5, 262, 94, 186, 39, 5, 771, 6654, 30, 160, 1054], 'feature': 205}, {'user': 0, 'user_index': 0, 'item': 3, 'item_index': 6222, 'hist_index': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3284, 3123, 4530], 'rating': 5, 'text': [12, 8, 76, 222, 43, 7, 4, 158], 'feature': 222}, {'user': 0, 'user_index': 0, 'item': 4, 'item_index': 959, 'hist_index': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3284, 3123, 4530, 6222], 'rating': 5, 'text': [12, 8, 5, 25, 11], 'feature': 11}, {'user': 0, 'user_index': 0, 'item': 5, 'item_index': 2557, 'hist_index': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3284, 3123, 4530, 6222, 959], 'rating': 5, 'text': [342, 4, 69, 447, 6, 4, 41, 18], 'feature': 4}, {'user': 0, 'user_index': 0, 'item': 6, 'item_index': 2699, 'hist_index': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3284, 3123, 4530, 6222, 959, 2557], 'rating': 5, 'text': [20, 131, 375, 6, 105, 24, 213, 246, 66, 8, 250, 9, 823, 412], 'feature': 105}, {'user': 0, 'user_index': 0, 'item': 7, 'item_index': 6482, 'hist_index': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3284, 3123, 4530, 6222, 959, 2557, 2699], 'rating': 5, 'text': [342, 4, 326, 186, 659, 9, 94, 13, 218, 23, 57, 419, 13, 1344, 20, 27, 209, 11], 'feature': 11}, {'user': 0, 'user_index': 0, 'item': 8, 'item_index': 2540, 'hist_index': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3284, 3123, 4530, 6222, 959, 2557, 2699, 6482], 'rating': 5, 'text': [116, 13, 18], 'feature': 13}, {'user': 0, 'user_index': 0, 'item': 9, 'item_index': 7139, 'hist_index': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3284, 3123, 4530, 6222, 959, 2557, 2699, 6482, 2540], 'rating': 5, 'text': [63, 24, 36, 1504, 1032, 52, 161, 12, 8, 4, 27, 9, 33], 'feature': 52}]
valid idx: [1512, 1513, 1514, 1515, 1516, 1517, 1518, 1519, 1520, 1521]
valid: [{'user': 31, 'user_index': 31, 'item': 1316, 'item_index': 2234, 'hist_index': [3916, 4755, 3261, 4047, 2617, 3254, 6737, 6761, 5460, 1392, 4902, 2646, 2811, 854, 6832, 1819, 4737, 1410, 1545, 6885], 'rating': 5, 'text': [4, 72, 123, 8, 2153, 55, 157, 3346, 9, 612, 6, 5984, 9, 11228], 'feature': 123}, {'user': 31, 'user_index': 31, 'item': 1317, 'item_index': 374, 'hist_index': [4755, 3261, 4047, 2617, 3254, 6737, 6761, 5460, 1392, 4902, 2646, 2811, 854, 6832, 1819, 4737, 1410, 1545, 6885, 2234], 'rating': 5, 'text': [14, 109, 2132, 9, 76, 1425, 3], 'feature': 1425}, {'user': 31, 'user_index': 31, 'item': 210, 'item_index': 5257, 'hist_index': [3261, 4047, 2617, 3254, 6737, 6761, 5460, 1392, 4902, 2646, 2811, 854, 6832, 1819, 4737, 1410, 1545, 6885, 2234, 374], 'rating': 5, 'text': [23, 62, 26, 456], 'feature': 456}, {'user': 31, 'user_index': 31, 'item': 1318, 'item_index': 6770, 'hist_index': [4047, 2617, 3254, 6737, 6761, 5460, 1392, 4902, 2646, 2811, 854, 6832, 1819, 4737, 1410, 1545, 6885, 2234, 374, 5257], 'rating': 5, 'text': [21, 84, 21, 4, 5536, 7, 117, 88, 656, 185, 12, 5, 262, 34, 22, 121], 'feature': 88}, {'user': 31, 'user_index': 31, 'item': 777, 'item_index': 4740, 'hist_index': [2617, 3254, 6737, 6761, 5460, 1392, 4902, 2646, 2811, 854, 6832, 1819, 4737, 1410, 1545, 6885, 2234, 374, 5257, 6770], 'rating': 5, 'text': [6, 93, 57, 4, 15463, 7, 13633, 5, 137, 337], 'feature': 337}, {'user': 31, 'user_index': 31, 'item': 1319, 'item_index': 2729, 'hist_index': [3254, 6737, 6761, 5460, 1392, 4902, 2646, 2811, 854, 6832, 1819, 4737, 1410, 1545, 6885, 2234, 374, 5257, 6770, 4740], 'rating': 3, 'text': [541, 37, 412, 569, 11, 79, 115, 166, 189, 9, 67, 154, 3617], 'feature': 11}, {'user': 31, 'user_index': 31, 'item': 1320, 'item_index': 6487, 'hist_index': [6737, 6761, 5460, 1392, 4902, 2646, 2811, 854, 6832, 1819, 4737, 1410, 1545, 6885, 2234, 374, 5257, 6770, 4740, 2729], 'rating': 3, 'text': [352, 84, 161, 105, 73, 5, 953, 372], 'feature': 105}, {'user': 31, 'user_index': 31, 'item': 310, 'item_index': 2263, 'hist_index': [6761, 5460, 1392, 4902, 2646, 2811, 854, 6832, 1819, 4737, 1410, 1545, 6885, 2234, 374, 5257, 6770, 4740, 2729, 6487], 'rating': 5, 'text': [378, 493, 101, 4599, 224, 6, 238, 1401, 8, 193, 5, 6519], 'feature': 224}, {'user': 31, 'user_index': 31, 'item': 1321, 'item_index': 592, 'hist_index': [5460, 1392, 4902, 2646, 2811, 854, 6832, 1819, 4737, 1410, 1545, 6885, 2234, 374, 5257, 6770, 4740, 2729, 6487, 2263], 'rating': 2, 'text': [101, 298, 9, 621, 63, 6943, 8, 5, 534, 1036, 303, 30, 3], 'feature': 303}, {'user': 31, 'user_index': 31, 'item': 1322, 'item_index': 2687, 'hist_index': [1392, 4902, 2646, 2811, 854, 6832, 1819, 4737, 1410, 1545, 6885, 2234, 374, 5257, 6770, 4740, 2729, 6487, 2263, 592], 'rating': 4, 'text': [1906, 665, 343, 325, 664, 38, 1417, 159, 160, 137, 196], 'feature': 196}]
test idx: [1701, 1702, 1703, 1704, 1705, 1706, 1707, 1708, 1709, 1710]
test: [{'user': 34, 'user_index': 34, 'item': 1447, 'item_index': 2715, 'hist_index': [2602, 1677, 2593, 1955, 255, 1034, 306, 760, 1540, 2732, 3080, 3765, 6665, 6621, 1100, 5083, 6818, 6762, 4829, 348], 'rating': 4, 'text': [13, 8, 39, 139, 679, 82, 15], 'feature': 82}, {'user': 34, 'user_index': 34, 'item': 1448, 'item_index': 7328, 'hist_index': [1677, 2593, 1955, 255, 1034, 306, 760, 1540, 2732, 3080, 3765, 6665, 6621, 1100, 5083, 6818, 6762, 4829, 348, 2715], 'rating': 4, 'text': [23, 12, 976, 67, 91, 13132, 76, 1143, 3779, 20, 5, 544, 224, 354], 'feature': 224}, {'user': 34, 'user_index': 34, 'item': 1265, 'item_index': 3486, 'hist_index': [2593, 1955, 255, 1034, 306, 760, 1540, 2732, 3080, 3765, 6665, 6621, 1100, 5083, 6818, 6762, 4829, 348, 2715, 7328], 'rating': 5, 'text': [6, 1786, 4, 11, 1022, 4, 6217, 2393, 285, 12, 434, 6, 3, 73, 5, 2194, 893, 7, 5, 561, 273, 717], 'feature': 11}, {'user': 34, 'user_index': 34, 'item': 1449, 'item_index': 3856, 'hist_index': [1955, 255, 1034, 306, 760, 1540, 2732, 3080, 3765, 6665, 6621, 1100, 5083, 6818, 6762, 4829, 348, 2715, 7328, 3486], 'rating': 1, 'text': [4, 83, 19, 39, 140], 'feature': 83}, {'user': 34, 'user_index': 34, 'item': 967, 'item_index': 3409, 'hist_index': [255, 1034, 306, 760, 1540, 2732, 3080, 3765, 6665, 6621, 1100, 5083, 6818, 6762, 4829, 348, 2715, 7328, 3486, 3856], 'rating': 4, 'text': [1635, 3975, 368, 4, 257, 7, 9506, 3, 213, 68, 246, 80, 29, 24, 103, 1754, 305, 22, 80, 29, 6, 341, 24, 103, 9309, 126, 124, 6371, 80, 165, 18], 'feature': 6371}, {'user': 34, 'user_index': 34, 'item': 1450, 'item_index': 867, 'hist_index': [1034, 306, 760, 1540, 2732, 3080, 3765, 6665, 6621, 1100, 5083, 6818, 6762, 4829, 348, 2715, 7328, 3486, 3856, 3409], 'rating': 4, 'text': [6, 2487, 9961, 1922, 43, 12, 915, 41], 'feature': 41}, {'user': 34, 'user_index': 34, 'item': 573, 'item_index': 5590, 'hist_index': [306, 760, 1540, 2732, 3080, 3765, 6665, 6621, 1100, 5083, 6818, 6762, 4829, 348, 2715, 7328, 3486, 3856, 3409, 867], 'rating': 5, 'text': [164, 134, 585, 47, 28, 3, 45, 50, 1112, 1937, 31, 57, 419, 50, 93, 1112, 10, 4, 433, 2182, 32], 'feature': 47}, {'user': 34, 'user_index': 34, 'item': 1451, 'item_index': 5340, 'hist_index': [760, 1540, 2732, 3080, 3765, 6665, 6621, 1100, 5083, 6818, 6762, 4829, 348, 2715, 7328, 3486, 3856, 3409, 867, 5590], 'rating': 4, 'text': [12, 463, 15, 8, 277, 7, 4, 4428, 165, 2819, 16, 513, 249, 2338], 'feature': 15}, {'user': 34, 'user_index': 34, 'item': 1452, 'item_index': 4578, 'hist_index': [1540, 2732, 3080, 3765, 6665, 6621, 1100, 5083, 6818, 6762, 4829, 348, 2715, 7328, 3486, 3856, 3409, 867, 5590, 5340], 'rating': 2, 'text': [4, 56, 8, 753], 'feature': 56}, {'user': 34, 'user_index': 34, 'item': 1453, 'item_index': 2667, 'hist_index': [2732, 3080, 3765, 6665, 6621, 1100, 5083, 6818, 6762, 4829, 348, 2715, 7328, 3486, 3856, 3409, 867, 5590, 5340, 4578], 'rating': 5, 'text': [44, 8, 2070, 3027, 10, 37, 17035, 9, 239, 4, 310, 60, 4, 3, 287, 10, 4, 146], 'feature': 310}]
[2022-12-16 14:53:04.67]: Build Model
-------------------------FMLP ARGUMENTS-------------------------
data_dir                       FMLPETER/data/
output_dir                     FMLPETER/output/
data_name                      Movie_and_TV_GT5
do_eval                        True
load_model                     FMLPRec-Movie_and_TV_GT5-Dec-09-2022_17-02-48
model_name                     FMLPRec
hidden_size                    512
num_hidden_layers              4
num_attention_heads            2
hidden_act                     gelu
attention_probs_dropout_prob   0.5
hidden_dropout_prob            0.5
initializer_range              0.02
max_seq_length                 20
no_filters                     False
lr                             0.001
batch_size                     512
epochs                         100
no_cuda                        False
log_freq                       1
full_sort                      False
patience                       5
seed                           42
weight_decay                   0.0
adam_beta1                     0.9
adam_beta2                     0.99
gpu_id                         0
variance                       5
cuda_condition                 True
log_file                       FMLPETER/output/FMLPRec-Movie_and_TV_GT5-2022-12-16 14:53:07.28.txt
-------------------------FMLP ARGUMENTS-------------------------
Total Parameters: 12232192
Load model from FMLPETER/output/FMLPRec-Movie_and_TV_GT5-Dec-09-2022_17-02-48.pt for test!
[2022-12-16 14:53:20.03]: epoch 1
[2022-12-16 14:53:45.26]: context ppl 1581.0976 | text ppl 968.7331 | rating loss 2.7699 |   324/ 1404 batches
[2022-12-16 14:54:10.54]: context ppl 775.1214 | text ppl 298.5012 | rating loss 1.8200 |   648/ 1404 batches
[2022-12-16 14:54:35.73]: context ppl 700.7078 | text ppl 207.1708 | rating loss 1.8352 |   972/ 1404 batches
[2022-12-16 14:55:01.13]: context ppl 681.6745 | text ppl 174.8109 | rating loss 1.7108 |  1296/ 1404 batches
[2022-12-16 14:55:09.55]: context ppl 645.7003 | text ppl 150.2834 | rating loss 1.7318 |  1404/ 1404 batches
[2022-12-16 14:55:13.78]: context ppl 698.5686 | text ppl 146.6121 | rating loss 1.4974 | valid loss 6.4852 on validation
[2022-12-16 14:55:14.39]: epoch 2
[2022-12-16 14:55:40.12]: context ppl 658.8453 | text ppl 142.3899 | rating loss 1.4917 |   324/ 1404 batches
[2022-12-16 14:56:05.57]: context ppl 641.1959 | text ppl 127.0657 | rating loss 1.4924 |   648/ 1404 batches
[2022-12-16 14:56:30.81]: context ppl 631.2474 | text ppl 116.7737 | rating loss 1.4499 |   972/ 1404 batches
[2022-12-16 14:56:55.78]: context ppl 625.1155 | text ppl 109.0788 | rating loss 1.4634 |  1296/ 1404 batches
[2022-12-16 14:57:04.00]: context ppl 622.6689 | text ppl 105.8240 | rating loss 1.4452 |  1404/ 1404 batches
[2022-12-16 14:57:08.29]: context ppl 614.7273 | text ppl 96.5532 | rating loss 1.4409 | valid loss 6.0110 on validation
[2022-12-16 14:57:08.87]: epoch 3
[2022-12-16 14:57:34.40]: context ppl 616.1025 | text ppl 98.4762 | rating loss 1.4340 |   324/ 1404 batches
[2022-12-16 14:57:59.49]: context ppl 615.2403 | text ppl 95.3678 | rating loss 1.4659 |   648/ 1404 batches
[2022-12-16 14:58:24.27]: context ppl 613.6105 | text ppl 91.7585 | rating loss 1.4674 |   972/ 1404 batches
[2022-12-16 14:58:49.46]: context ppl 611.6301 | text ppl 89.3970 | rating loss 1.4350 |  1296/ 1404 batches
[2022-12-16 14:58:57.87]: context ppl 610.1542 | text ppl 88.2646 | rating loss 1.4440 |  1404/ 1404 batches
[2022-12-16 14:59:02.06]: context ppl 607.0425 | text ppl 79.6956 | rating loss 1.4277 | valid loss 5.8059 on validation
[2022-12-16 14:59:02.60]: epoch 4
[2022-12-16 14:59:27.95]: context ppl 608.5132 | text ppl 83.1608 | rating loss 1.4391 |   324/ 1404 batches
[2022-12-16 14:59:52.68]: context ppl 603.4698 | text ppl 81.3796 | rating loss 1.4302 |   648/ 1404 batches
[2022-12-16 15:00:17.60]: context ppl 603.5742 | text ppl 80.1912 | rating loss 1.4456 |   972/ 1404 batches
[2022-12-16 15:00:42.31]: context ppl 601.2001 | text ppl 78.3872 | rating loss 1.4328 |  1296/ 1404 batches
[2022-12-16 15:00:50.56]: context ppl 600.3628 | text ppl 76.9751 | rating loss 1.4404 |  1404/ 1404 batches
[2022-12-16 15:00:54.76]: context ppl 618.2191 | text ppl 72.1297 | rating loss 1.4169 | valid loss 5.6954 on validation
[2022-12-16 15:00:55.33]: epoch 5
[2022-12-16 15:01:20.34]: context ppl 596.6978 | text ppl 73.8374 | rating loss 1.4391 |   324/ 1404 batches
[2022-12-16 15:01:45.14]: context ppl 596.1556 | text ppl 72.7604 | rating loss 1.4364 |   648/ 1404 batches
[2022-12-16 15:02:09.98]: context ppl 597.9157 | text ppl 72.6200 | rating loss 1.4465 |   972/ 1404 batches
[2022-12-16 15:02:35.02]: context ppl 596.4176 | text ppl 71.5170 | rating loss 1.4542 |  1296/ 1404 batches
[2022-12-16 15:02:43.28]: context ppl 591.9745 | text ppl 70.7939 | rating loss 1.4268 |  1404/ 1404 batches
[2022-12-16 15:02:47.47]: context ppl 599.9553 | text ppl 66.7868 | rating loss 1.4452 | valid loss 5.6467 on validation
[2022-12-16 15:02:48.05]: epoch 6
[2022-12-16 15:03:13.44]: context ppl 590.7977 | text ppl 67.6445 | rating loss 1.4330 |   324/ 1404 batches
[2022-12-16 15:03:38.50]: context ppl 591.5557 | text ppl 67.2594 | rating loss 1.4340 |   648/ 1404 batches
[2022-12-16 15:04:03.65]: context ppl 589.9369 | text ppl 66.9036 | rating loss 1.4464 |   972/ 1404 batches
[2022-12-16 15:04:28.76]: context ppl 588.2517 | text ppl 66.5076 | rating loss 1.4237 |  1296/ 1404 batches
[2022-12-16 15:04:37.15]: context ppl 589.1164 | text ppl 66.2171 | rating loss 1.4344 |  1404/ 1404 batches
[2022-12-16 15:04:41.36]: context ppl 597.7319 | text ppl 63.8792 | rating loss 1.3888 | valid loss 5.5458 on validation
[2022-12-16 15:04:41.93]: epoch 7
[2022-12-16 15:05:07.58]: context ppl 584.5570 | text ppl 63.1201 | rating loss 1.4108 |   324/ 1404 batches
[2022-12-16 15:05:33.32]: context ppl 586.4955 | text ppl 63.4143 | rating loss 1.3889 |   648/ 1404 batches
[2022-12-16 15:05:58.76]: context ppl 581.3885 | text ppl 62.5449 | rating loss 1.3754 |   972/ 1404 batches
[2022-12-16 15:06:24.30]: context ppl 581.5165 | text ppl 62.5693 | rating loss 1.3744 |  1296/ 1404 batches
[2022-12-16 15:06:32.82]: context ppl 579.0517 | text ppl 62.0737 | rating loss 1.3601 |  1404/ 1404 batches
[2022-12-16 15:06:37.11]: context ppl 586.0148 | text ppl 60.1285 | rating loss 1.3301 | valid loss 5.4266 on validation
[2022-12-16 15:06:37.70]: epoch 8
[2022-12-16 15:07:03.50]: context ppl 577.2389 | text ppl 59.5994 | rating loss 1.3686 |   324/ 1404 batches
[2022-12-16 15:07:28.92]: context ppl 577.9980 | text ppl 59.8799 | rating loss 1.3570 |   648/ 1404 batches
[2022-12-16 15:07:54.09]: context ppl 576.8604 | text ppl 59.6483 | rating loss 1.3222 |   972/ 1404 batches
[2022-12-16 15:08:19.58]: context ppl 571.4781 | text ppl 59.2422 | rating loss 1.3306 |  1296/ 1404 batches
[2022-12-16 15:08:28.08]: context ppl 574.3923 | text ppl 59.0571 | rating loss 1.3088 |  1404/ 1404 batches
[2022-12-16 15:08:32.36]: context ppl 579.5797 | text ppl 58.6506 | rating loss 1.2723 | valid loss 5.3439 on validation
[2022-12-16 15:08:32.95]: epoch 9
[2022-12-16 15:08:58.90]: context ppl 569.4202 | text ppl 56.7315 | rating loss 1.2992 |   324/ 1404 batches
[2022-12-16 15:09:24.73]: context ppl 568.5905 | text ppl 56.9025 | rating loss 1.2932 |   648/ 1404 batches
[2022-12-16 15:09:50.38]: context ppl 564.2090 | text ppl 56.4277 | rating loss 1.2939 |   972/ 1404 batches
[2022-12-16 15:10:15.60]: context ppl 566.4959 | text ppl 56.9050 | rating loss 1.2612 |  1296/ 1404 batches
[2022-12-16 15:10:23.85]: context ppl 566.6647 | text ppl 56.3253 | rating loss 1.2455 |  1404/ 1404 batches
[2022-12-16 15:10:28.12]: context ppl 577.2798 | text ppl 56.9247 | rating loss 1.2286 | valid loss 5.2704 on validation
[2022-12-16 15:10:28.66]: epoch 10
[2022-12-16 15:10:54.25]: context ppl 560.2105 | text ppl 54.2062 | rating loss 1.2551 |   324/ 1404 batches
[2022-12-16 15:11:19.29]: context ppl 557.8875 | text ppl 54.1109 | rating loss 1.2524 |   648/ 1404 batches
[2022-12-16 15:11:44.48]: context ppl 558.6206 | text ppl 54.4233 | rating loss 1.2259 |   972/ 1404 batches
[2022-12-16 15:12:09.70]: context ppl 557.6239 | text ppl 54.4405 | rating loss 1.2418 |  1296/ 1404 batches
[2022-12-16 15:12:17.97]: context ppl 557.6424 | text ppl 54.6333 | rating loss 1.2417 |  1404/ 1404 batches
[2022-12-16 15:12:22.34]: context ppl 565.0002 | text ppl 55.0546 | rating loss 1.2344 | valid loss 5.2427 on validation
[2022-12-16 15:12:22.94]: epoch 11
[2022-12-16 15:12:48.18]: context ppl 550.2027 | text ppl 51.8790 | rating loss 1.2053 |   324/ 1404 batches
[2022-12-16 15:13:13.41]: context ppl 549.0724 | text ppl 52.0741 | rating loss 1.2022 |   648/ 1404 batches
[2022-12-16 15:13:38.59]: context ppl 550.7955 | text ppl 52.3365 | rating loss 1.1871 |   972/ 1404 batches
[2022-12-16 15:14:03.81]: context ppl 549.8673 | text ppl 52.3323 | rating loss 1.1630 |  1296/ 1404 batches
[2022-12-16 15:14:12.26]: context ppl 548.9484 | text ppl 52.7106 | rating loss 1.1676 |  1404/ 1404 batches
[2022-12-16 15:14:16.64]: context ppl 557.6683 | text ppl 53.2086 | rating loss 1.2193 | valid loss 5.1936 on validation
[2022-12-16 15:14:17.23]: epoch 12
[2022-12-16 15:14:42.95]: context ppl 542.2700 | text ppl 49.8671 | rating loss 1.1682 |   324/ 1404 batches
[2022-12-16 15:15:08.33]: context ppl 541.9128 | text ppl 50.2994 | rating loss 1.1620 |   648/ 1404 batches
[2022-12-16 15:15:33.40]: context ppl 540.8898 | text ppl 50.6123 | rating loss 1.1649 |   972/ 1404 batches
[2022-12-16 15:15:58.65]: context ppl 541.8583 | text ppl 50.6701 | rating loss 1.1396 |  1296/ 1404 batches
[2022-12-16 15:16:07.04]: context ppl 541.3938 | text ppl 50.7400 | rating loss 1.1740 |  1404/ 1404 batches
[2022-12-16 15:16:11.26]: context ppl 552.8683 | text ppl 52.2220 | rating loss 1.3177 | valid loss 5.2732 on validation
[2022-12-16 15:16:11.26]: Endured 1 time(s)
[2022-12-16 15:16:11.26]: Learning rate set to 0.22500000
[2022-12-16 15:16:11.26]: epoch 13
[2022-12-16 15:16:36.61]: context ppl 524.7066 | text ppl 45.6899 | rating loss 1.0700 |   324/ 1404 batches
[2022-12-16 15:17:01.87]: context ppl 524.8679 | text ppl 45.6902 | rating loss 1.0654 |   648/ 1404 batches
[2022-12-16 15:17:26.91]: context ppl 524.0660 | text ppl 45.2980 | rating loss 1.0661 |   972/ 1404 batches
[2022-12-16 15:17:51.86]: context ppl 523.4980 | text ppl 45.1856 | rating loss 1.0641 |  1296/ 1404 batches
[2022-12-16 15:18:00.02]: context ppl 528.7123 | text ppl 45.7737 | rating loss 1.0608 |  1404/ 1404 batches
[2022-12-16 15:18:04.27]: context ppl 546.0089 | text ppl 49.7622 | rating loss 1.1840 | valid loss 5.0913 on validation
[2022-12-16 15:18:04.87]: epoch 14
[2022-12-16 15:18:30.19]: context ppl 519.3133 | text ppl 44.3857 | rating loss 1.0490 |   324/ 1404 batches
[2022-12-16 15:18:54.95]: context ppl 519.7095 | text ppl 44.1484 | rating loss 1.0574 |   648/ 1404 batches
[2022-12-16 15:19:19.80]: context ppl 521.9570 | text ppl 44.4770 | rating loss 1.0611 |   972/ 1404 batches
[2022-12-16 15:19:44.55]: context ppl 522.5570 | text ppl 44.8123 | rating loss 1.0585 |  1296/ 1404 batches
[2022-12-16 15:19:52.73]: context ppl 523.0773 | text ppl 44.8306 | rating loss 1.0521 |  1404/ 1404 batches
[2022-12-16 15:19:56.95]: context ppl 545.5737 | text ppl 49.3725 | rating loss 1.1861 | valid loss 5.0855 on validation
[2022-12-16 15:19:57.51]: epoch 15
[2022-12-16 15:20:22.93]: context ppl 516.7865 | text ppl 43.6221 | rating loss 1.0497 |   324/ 1404 batches
[2022-12-16 15:20:47.78]: context ppl 517.1980 | text ppl 43.7677 | rating loss 1.0484 |   648/ 1404 batches
[2022-12-16 15:21:12.82]: context ppl 518.3617 | text ppl 43.8675 | rating loss 1.0499 |   972/ 1404 batches
[2022-12-16 15:21:37.84]: context ppl 518.5183 | text ppl 43.9448 | rating loss 1.0433 |  1296/ 1404 batches
[2022-12-16 15:21:46.10]: context ppl 518.2996 | text ppl 44.1804 | rating loss 1.0526 |  1404/ 1404 batches
[2022-12-16 15:21:50.35]: context ppl 543.6549 | text ppl 49.1673 | rating loss 1.1805 | valid loss 5.0757 on validation
[2022-12-16 15:21:50.96]: epoch 16
[2022-12-16 15:22:16.39]: context ppl 512.6029 | text ppl 43.0241 | rating loss 1.0409 |   324/ 1404 batches
[2022-12-16 15:22:41.23]: context ppl 516.9086 | text ppl 43.4849 | rating loss 1.0359 |   648/ 1404 batches
[2022-12-16 15:23:05.94]: context ppl 514.9558 | text ppl 43.2291 | rating loss 1.0478 |   972/ 1404 batches
[2022-12-16 15:23:31.20]: context ppl 515.3072 | text ppl 43.4207 | rating loss 1.0388 |  1296/ 1404 batches
[2022-12-16 15:23:39.60]: context ppl 514.7201 | text ppl 43.5077 | rating loss 1.0687 |  1404/ 1404 batches
[2022-12-16 15:23:43.86]: context ppl 542.6856 | text ppl 48.9054 | rating loss 1.1951 | valid loss 5.0850 on validation
[2022-12-16 15:23:43.86]: Endured 2 time(s)
[2022-12-16 15:23:43.86]: Learning rate set to 0.05625000
[2022-12-16 15:23:43.86]: epoch 17
[2022-12-16 15:24:09.46]: context ppl 508.8703 | text ppl 42.1019 | rating loss 1.0291 |   324/ 1404 batches
[2022-12-16 15:24:34.48]: context ppl 511.5667 | text ppl 42.4045 | rating loss 1.0240 |   648/ 1404 batches
[2022-12-16 15:24:59.57]: context ppl 510.5243 | text ppl 41.9585 | rating loss 1.0304 |   972/ 1404 batches
[2022-12-16 15:25:24.76]: context ppl 510.4570 | text ppl 42.0969 | rating loss 1.0249 |  1296/ 1404 batches
[2022-12-16 15:25:33.14]: context ppl 507.7401 | text ppl 42.1191 | rating loss 1.0271 |  1404/ 1404 batches
[2022-12-16 15:25:37.38]: context ppl 541.5533 | text ppl 48.6231 | rating loss 1.1835 | valid loss 5.0676 on validation
[2022-12-16 15:25:37.93]: epoch 18
[2022-12-16 15:26:03.58]: context ppl 508.3780 | text ppl 41.6849 | rating loss 1.0185 |   324/ 1404 batches
[2022-12-16 15:26:29.00]: context ppl 509.0353 | text ppl 41.8357 | rating loss 1.0273 |   648/ 1404 batches
[2022-12-16 15:26:54.05]: context ppl 509.0147 | text ppl 41.9934 | rating loss 1.0252 |   972/ 1404 batches
[2022-12-16 15:27:19.10]: context ppl 509.7584 | text ppl 42.0741 | rating loss 1.0216 |  1296/ 1404 batches
[2022-12-16 15:27:27.42]: context ppl 506.6055 | text ppl 41.7707 | rating loss 1.0316 |  1404/ 1404 batches
[2022-12-16 15:27:31.62]: context ppl 541.0912 | text ppl 48.4933 | rating loss 1.1868 | valid loss 5.0682 on validation
[2022-12-16 15:27:31.62]: Endured 3 time(s)
[2022-12-16 15:27:31.62]: Learning rate set to 0.01406250
[2022-12-16 15:27:31.62]: epoch 19
[2022-12-16 15:27:56.95]: context ppl 507.5422 | text ppl 41.4637 | rating loss 1.0237 |   324/ 1404 batches
[2022-12-16 15:28:22.15]: context ppl 507.3995 | text ppl 41.5767 | rating loss 1.0291 |   648/ 1404 batches
[2022-12-16 15:28:47.34]: context ppl 508.7955 | text ppl 41.5166 | rating loss 1.0219 |   972/ 1404 batches
[2022-12-16 15:29:12.70]: context ppl 506.8010 | text ppl 41.7114 | rating loss 1.0122 |  1296/ 1404 batches
[2022-12-16 15:29:21.08]: context ppl 505.0233 | text ppl 41.3459 | rating loss 1.0206 |  1404/ 1404 batches
[2022-12-16 15:29:25.32]: context ppl 541.1282 | text ppl 48.4905 | rating loss 1.1803 | valid loss 5.0617 on validation
[2022-12-16 15:29:25.85]: epoch 20
[2022-12-16 15:29:51.56]: context ppl 510.2465 | text ppl 41.5407 | rating loss 1.0159 |   324/ 1404 batches
[2022-12-16 15:30:16.99]: context ppl 506.5157 | text ppl 41.5561 | rating loss 1.0255 |   648/ 1404 batches
[2022-12-16 15:30:41.89]: context ppl 506.6932 | text ppl 41.3920 | rating loss 1.0214 |   972/ 1404 batches
[2022-12-16 15:31:07.05]: context ppl 506.0781 | text ppl 41.5093 | rating loss 1.0232 |  1296/ 1404 batches
[2022-12-16 15:31:15.33]: context ppl 506.6646 | text ppl 41.3692 | rating loss 1.0045 |  1404/ 1404 batches
[2022-12-16 15:31:19.56]: context ppl 540.6712 | text ppl 48.4477 | rating loss 1.1809 | valid loss 5.0614 on validation
[2022-12-16 15:31:20.11]: epoch 21
[2022-12-16 15:31:45.52]: context ppl 506.0572 | text ppl 41.2986 | rating loss 1.0236 |   324/ 1404 batches
[2022-12-16 15:32:10.56]: context ppl 507.1244 | text ppl 41.4252 | rating loss 1.0228 |   648/ 1404 batches
[2022-12-16 15:32:35.62]: context ppl 507.5609 | text ppl 41.3873 | rating loss 1.0174 |   972/ 1404 batches
[2022-12-16 15:33:00.75]: context ppl 506.6048 | text ppl 41.5785 | rating loss 1.0134 |  1296/ 1404 batches
[2022-12-16 15:33:09.13]: context ppl 508.2664 | text ppl 41.6338 | rating loss 1.0164 |  1404/ 1404 batches
[2022-12-16 15:33:13.35]: context ppl 540.5845 | text ppl 48.4121 | rating loss 1.1793 | valid loss 5.0590 on validation
[2022-12-16 15:33:13.90]: epoch 22
[2022-12-16 15:33:39.28]: context ppl 507.2111 | text ppl 41.2773 | rating loss 1.0154 |   324/ 1404 batches
[2022-12-16 15:34:04.24]: context ppl 506.3951 | text ppl 41.2862 | rating loss 1.0228 |   648/ 1404 batches
[2022-12-16 15:34:29.37]: context ppl 505.4956 | text ppl 41.3473 | rating loss 1.0227 |   972/ 1404 batches
[2022-12-16 15:34:54.47]: context ppl 507.5946 | text ppl 41.5599 | rating loss 1.0154 |  1296/ 1404 batches
[2022-12-16 15:35:02.81]: context ppl 507.8359 | text ppl 41.8954 | rating loss 1.0133 |  1404/ 1404 batches
[2022-12-16 15:35:07.10]: context ppl 540.5102 | text ppl 48.3952 | rating loss 1.1793 | valid loss 5.0587 on validation
[2022-12-16 15:35:07.66]: epoch 23
[2022-12-16 15:35:33.29]: context ppl 507.2584 | text ppl 41.4291 | rating loss 1.0316 |   324/ 1404 batches
[2022-12-16 15:35:58.47]: context ppl 506.8076 | text ppl 41.1110 | rating loss 1.0138 |   648/ 1404 batches
[2022-12-16 15:36:23.53]: context ppl 506.5276 | text ppl 41.4377 | rating loss 1.0091 |   972/ 1404 batches
[2022-12-16 15:36:48.63]: context ppl 507.4048 | text ppl 41.4284 | rating loss 1.0160 |  1296/ 1404 batches
[2022-12-16 15:36:56.92]: context ppl 501.6982 | text ppl 41.3742 | rating loss 1.0216 |  1404/ 1404 batches
[2022-12-16 15:37:01.12]: context ppl 540.7669 | text ppl 48.3803 | rating loss 1.1813 | valid loss 5.0604 on validation
[2022-12-16 15:37:01.12]: Endured 4 time(s)
[2022-12-16 15:37:01.12]: Learning rate set to 0.00351563
[2022-12-16 15:37:01.12]: epoch 24
[2022-12-16 15:37:26.55]: context ppl 505.8949 | text ppl 41.3039 | rating loss 1.0179 |   324/ 1404 batches
[2022-12-16 15:37:51.69]: context ppl 504.8714 | text ppl 41.1684 | rating loss 1.0138 |   648/ 1404 batches
[2022-12-16 15:38:16.78]: context ppl 506.0400 | text ppl 41.2251 | rating loss 1.0185 |   972/ 1404 batches
[2022-12-16 15:38:41.83]: context ppl 507.8599 | text ppl 41.2924 | rating loss 1.0189 |  1296/ 1404 batches
[2022-12-16 15:38:50.32]: context ppl 505.5968 | text ppl 41.2414 | rating loss 1.0306 |  1404/ 1404 batches
[2022-12-16 15:38:54.60]: context ppl 540.5032 | text ppl 48.3770 | rating loss 1.1797 | valid loss 5.0587 on validation
[2022-12-16 15:38:54.60]: Endured 5 time(s)
[2022-12-16 15:38:54.60]: Learning rate set to 0.00087891
[2022-12-16 15:38:54.60]: epoch 25
[2022-12-16 15:39:20.17]: context ppl 506.1754 | text ppl 41.1171 | rating loss 1.0135 |   324/ 1404 batches
[2022-12-16 15:39:45.50]: context ppl 505.0778 | text ppl 41.3076 | rating loss 1.0178 |   648/ 1404 batches
[2022-12-16 15:40:10.80]: context ppl 505.7152 | text ppl 41.1120 | rating loss 1.0187 |   972/ 1404 batches
[2022-12-16 15:40:36.06]: context ppl 506.6276 | text ppl 41.3762 | rating loss 1.0187 |  1296/ 1404 batches
[2022-12-16 15:40:44.51]: context ppl 509.6290 | text ppl 41.4955 | rating loss 1.0242 |  1404/ 1404 batches
[2022-12-16 15:40:48.78]: context ppl 540.4932 | text ppl 48.3767 | rating loss 1.1799 | valid loss 5.0589 on validation
[2022-12-16 15:40:48.78]: Endured 6 time(s)
[2022-12-16 15:40:48.78]: Learning rate set to 0.00021973
[2022-12-16 15:40:48.78]: epoch 26
[2022-12-16 15:41:14.41]: context ppl 505.7154 | text ppl 41.2402 | rating loss 1.0112 |   324/ 1404 batches
[2022-12-16 15:41:39.49]: context ppl 506.6045 | text ppl 41.4513 | rating loss 1.0191 |   648/ 1404 batches
[2022-12-16 15:42:04.83]: context ppl 504.1195 | text ppl 41.1363 | rating loss 1.0221 |   972/ 1404 batches
[2022-12-16 15:42:29.47]: context ppl 506.7044 | text ppl 41.0475 | rating loss 1.0168 |  1296/ 1404 batches
[2022-12-16 15:42:37.75]: context ppl 509.0091 | text ppl 41.4227 | rating loss 1.0198 |  1404/ 1404 batches
[2022-12-16 15:42:42.00]: context ppl 540.5011 | text ppl 48.3749 | rating loss 1.1800 | valid loss 5.0590 on validation
[2022-12-16 15:42:42.00]: Endured 7 time(s)
[2022-12-16 15:42:42.00]: Learning rate set to 0.00005493
[2022-12-16 15:42:42.00]: epoch 27
[2022-12-16 15:43:07.95]: context ppl 504.7296 | text ppl 41.1757 | rating loss 1.0148 |   324/ 1404 batches
[2022-12-16 15:43:33.39]: context ppl 507.9578 | text ppl 41.4105 | rating loss 1.0229 |   648/ 1404 batches
[2022-12-16 15:43:58.56]: context ppl 503.2642 | text ppl 41.0728 | rating loss 1.0156 |   972/ 1404 batches
[2022-12-16 15:44:23.79]: context ppl 505.8391 | text ppl 41.2504 | rating loss 1.0102 |  1296/ 1404 batches
[2022-12-16 15:44:32.16]: context ppl 511.3929 | text ppl 41.4025 | rating loss 1.0219 |  1404/ 1404 batches
[2022-12-16 15:44:36.45]: context ppl 540.5051 | text ppl 48.3747 | rating loss 1.1800 | valid loss 5.0590 on validation
[2022-12-16 15:44:36.45]: Endured 8 time(s)
[2022-12-16 15:44:36.45]: Learning rate set to 0.00001373
[2022-12-16 15:44:36.45]: epoch 28
[2022-12-16 15:45:02.29]: context ppl 506.3393 | text ppl 41.3498 | rating loss 1.0147 |   324/ 1404 batches
[2022-12-16 15:45:27.79]: context ppl 505.6555 | text ppl 41.0867 | rating loss 1.0206 |   648/ 1404 batches
[2022-12-16 15:45:53.29]: context ppl 508.2309 | text ppl 41.4045 | rating loss 1.0137 |   972/ 1404 batches
[2022-12-16 15:46:19.07]: context ppl 503.6973 | text ppl 41.1853 | rating loss 1.0131 |  1296/ 1404 batches
[2022-12-16 15:46:27.65]: context ppl 505.0453 | text ppl 41.1025 | rating loss 1.0246 |  1404/ 1404 batches
[2022-12-16 15:46:31.96]: context ppl 540.5064 | text ppl 48.3748 | rating loss 1.1800 | valid loss 5.0590 on validation
[2022-12-16 15:46:31.96]: Endured 9 time(s)
[2022-12-16 15:46:31.96]: Learning rate set to 0.00000343
[2022-12-16 15:46:31.96]: epoch 29
[2022-12-16 15:46:57.97]: context ppl 506.7808 | text ppl 41.2065 | rating loss 1.0077 |   324/ 1404 batches
[2022-12-16 15:47:23.74]: context ppl 504.8771 | text ppl 41.1772 | rating loss 1.0231 |   648/ 1404 batches
[2022-12-16 15:47:49.43]: context ppl 506.3093 | text ppl 41.3961 | rating loss 1.0197 |   972/ 1404 batches
[2022-12-16 15:48:14.87]: context ppl 506.0349 | text ppl 41.1615 | rating loss 1.0132 |  1296/ 1404 batches
[2022-12-16 15:48:23.37]: context ppl 507.1498 | text ppl 41.2343 | rating loss 1.0221 |  1404/ 1404 batches
[2022-12-16 15:48:27.69]: context ppl 540.5066 | text ppl 48.3748 | rating loss 1.1800 | valid loss 5.0590 on validation
[2022-12-16 15:48:27.69]: Endured 10 time(s)
[2022-12-16 15:48:27.69]: Cannot endure it anymore | Exiting from early stop
=========================================================================================
[2022-12-16 15:48:32.11]: context ppl 539.8537 | text ppl 48.4448 | rating loss 1.1570 on test | End of training
[2022-12-16 15:48:32.11]: Generating text
[2022-12-16 15:49:01.59]: RMSE  1.0756
[2022-12-16 15:49:02.05]: MAE  0.8380
[2022-12-16 15:49:04.71]: BLEU-1 18.6165
[2022-12-16 15:49:11.53]: BLEU-4  2.5006
[2022-12-16 15:49:25.19]: USR  0.1921 | USN    7923
[2022-12-16 15:54:38.09]: DIV  1.2735
[2022-12-16 15:54:39.16]: FCR  0.1924
[2022-12-16 15:54:39.17]: FMR  0.7890
[2022-12-16 15:54:45.50]: rouge_1/f_score 25.6554
[2022-12-16 15:54:45.50]: rouge_1/r_score 22.9636
[2022-12-16 15:54:45.50]: rouge_1/p_score 35.0341
[2022-12-16 15:54:45.50]: rouge_2/f_score  6.0960
[2022-12-16 15:54:45.50]: rouge_2/r_score  5.5922
[2022-12-16 15:54:45.50]: rouge_2/p_score  8.4468
[2022-12-16 15:54:45.50]: rouge_l/f_score 18.9316
[2022-12-16 15:54:45.50]: rouge_l/r_score 20.3572
[2022-12-16 15:54:45.50]: rouge_l/p_score 27.9216
[2022-12-16 15:54:45.62]: Generated text saved to (FMLPETER/output/generated_seed1234.txt)
